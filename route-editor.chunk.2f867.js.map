{"version":3,"sources":["webpack:///./routes/editor/index.tsx","webpack:///./components/list/index.tsx","webpack:///./hooks/media_query.ts","webpack:///../src/util.js","webpack:///../src/index.js","webpack:///./utils/redirect.ts"],"names":["Editor","file","fs","useContext","FileSystemContext","useState","zoom","setZoom","map","setMap","editing","all","to","saveURL","URL","createObjectURL","Blob","render","Provider","value","readonly","type","h","Grid","List","onZoomChange","class","checked","onInput","e","currentTarget","style","name","download","href","onClick","undo","redo","prevent","event","preventDefault","observer","MutationObserver","mutations","input","addedNodes","HTMLElement","querySelector","focus","query","matches","setMatches","active","useRef","container","phone","useEffect","change","matchList","window","matchMedia","addEventListener","removeEventListener","tree","observe","current","childList","subtree","disconnect","previousLevel","item","key","Array","isArray","children","length","index","findIndex","nested","indexOf","returns","i","filter","splice","add","some","top","includes","text","ref","onKeyUp","Math","floor","random","array","measure","lines","width","rows","onFocus","onBlur","tabIndex","onKeyDown","ctrlKey","slice","selectionStart","selectionEnd","shiftKey","n","a","concat","placeholder","props","onMouseDown","role","encodeEntities","s","String","ENCODED_ENTITIES","test","replace","styleObjToCss","str","prop","val","JS_TO_CSS","toLowerCase","IS_NON_DIMENSIONAL","undefined","assign","obj","getChildren","accumulator","reduce","push","renderToString","vnode","context","opts","previousSkipEffects","options","__s","res","_renderToString","__c","EMPTY_ARR","inner","isSvgMode","selectValue","pretty","indentChar","rendered","component","nodeName","isComponent","shallow","renderRootComponent","Fragment","shallowHighOrder","c","__v","setState","noop","forceUpdate","__h","__b","__r","prototype","cxType","contextType","provider","cctx","__","_dirty","__d","state","_nextState","getDerivedStateFromProps","componentWillMount","call","getChildContext","diffed","displayName","Function","toString","match","UNNAMED","propChildren","html","attrs","Object","keys","sortAttributes","sort","v","UNSAFE_NAME","allAttributes","hooked","attributeHook","__html","xml","selected","sub","Error","isVoid","VOID_ELEMENTS","voidElements","pieces","isLargeString","indent","hasLarge","lastWasText","child","ret","isText","join","substring","char","ignoreLines","SHALLOW","shallowRender","Redirect","route","this","Component"],"mappings":"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","file":"route-editor.chunk.2f867.js","sourcesContent":["import {h, FunctionComponent, Fragment} from \"preact\";\r\nimport {useContext, useState} from \"preact/hooks\";\r\nimport FileSystemContext from \"components/filesystem/context\";\r\nimport List from \"components/list\";\r\nimport Grid from \"components/grid\";\r\nimport {Tree} from \"utils/tree\";\r\nimport Icon from \"components/icon\";\r\nimport Redirect from \"utils/redirect\";\r\nimport render from \"preact-render-to-string\";\r\nimport \"./style.scss\";\r\n\r\nconst Editor: FunctionComponent<Editor.Props> = ({file}) => {\r\n\tconst fs = useContext(FileSystemContext);\r\n\tconst [zoom, setZoom] = useState(1);\r\n\tconst [map, setMap] = useState(true);\r\n\tconst editing = +file;\r\n\tif (!(editing in fs.all)) {\r\n\t\treturn <Redirect to=\"/\" />;\r\n\t}\r\n\tconst saveURL = URL.createObjectURL(\r\n\t\tnew Blob(\r\n\t\t\t[render(\r\n\t\t\t\t<FileSystemContext.Provider value={fs}>\r\n\t\t\t\t\t<Grid editing={editing} readonly=\"standalone\" />\r\n\t\t\t\t</FileSystemContext.Provider>\r\n\t\t\t)],\r\n\t\t\t{\r\n\t\t\t\ttype: \"image/svg+xml\"\r\n\t\t\t}\r\n\t\t)\r\n\t)\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{h(map ? Grid : List, {editing, onZoomChange: setZoom, zoom})}\r\n\t\t\t<div class=\"vertical toolbar\">\r\n\t\t\t\t<button>\r\n\t\t\t\t\t<label>\r\n\t\t\t\t\t\t<input type=\"checkbox\" checked={map} onInput={e => setMap(e.currentTarget.checked)} />\r\n\t\t\t\t\t\t<Icon style=\"round\" name=\"\" />\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button>\r\n\t\t\t\t\t<a download=\"vise.svg\" href={saveURL}>\r\n\t\t\t\t\t\t<Icon name=\"save_alt\" />\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tif (zoom > 0.25) {\r\n\t\t\t\t\t\t\tsetZoom(zoom - 0.25);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Icon name=\"zoom_out\" style=\"outlined\" />\r\n\t\t\t\t</button>\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tif (zoom <= 2.5) {\r\n\t\t\t\t\t\t\tsetZoom(zoom + 0.25);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Icon name=\"zoom_in\" style=\"outlined\" />\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"horizontal toolbar\">\r\n\t\t\t\t<button onClick={() => fs.undo()}>\r\n\t\t\t\t\t<Icon name=\"undo\" />\r\n\t\t\t\t</button>\r\n\t\t\t\t<button onClick={() => fs.redo()}>\r\n\t\t\t\t\t<Icon name=\"redo\" />\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n\r\n};\r\n\r\ndeclare namespace Editor {\r\n\texport interface Props {\r\n\t\tfile: `${number}`;\r\n\t}\r\n\r\n\texport interface State {\r\n\t\tundo: Tree.Data[];\r\n\t\tredo: Tree.Data[];\r\n\t\tzoom: number;\r\n\t\tview: string;\r\n\t}\r\n}\r\n\r\nexport default Editor;\r\n","/**\r\n * @author Tomáš Wróbel\r\n * @license MIT\r\n *\r\n * I am the component providing list view.\r\n * A list is fast to view and edit\r\n * but has nothing to do with maps\r\n */\r\nimport {h, FunctionComponent} from \"preact\";\r\nimport {useContext, useEffect, useRef} from \"preact/hooks\";\r\nimport FileSystemContext from \"../filesystem/context\";\r\nimport Icon from \"../icon\";\r\nimport \"./style.scss\";\r\nimport measure from \"utils/wrapText\";\r\nimport useMediaQuery from \"hooks/media_query\";\r\n\r\nconst focus: MutationCallback = (mutations) => {\r\n\tfor (const mutation of mutations) {\r\n\t\tconst input = mutation.addedNodes[0];\r\n\r\n\t\tif (input instanceof HTMLElement) {\r\n\t\t\tinput.querySelector(\"textarea\")?.focus?.();\r\n\t\t}\r\n\t}\r\n};\r\n\r\nfunction prevent(event: Event) {\r\n\tevent.preventDefault();\r\n}\r\n\r\nconst observer = new MutationObserver(focus);\r\n\r\nconst List: FunctionComponent<List.Props> = ({editing, zoom = 1}) => {\r\n\tconst active = useRef<List.Item | null>(null);\r\n\tconst fs = useContext(FileSystemContext);\r\n\tconst container = useRef<HTMLDivElement>(null);\r\n\tconst phone = useMediaQuery(\"(max-width: 640px)\");\r\n\tconst tree = fs.all[editing];\r\n\r\n\tuseEffect(() => {\r\n\t\tobserver.observe(container.current!, {\r\n\t\t\tchildList: true,\r\n\t\t\tsubtree: true,\r\n\t\t});\r\n\r\n\t\treturn () => observer.disconnect();\r\n\t});\r\n\r\n\tconst previousLevel = (item: List.Item) => fs.change(\r\n\t\tediting,\r\n\t\t(key, value: List.Item) => {\r\n\t\t\tif (key !== \"width\" && key !== \"height\" && key !== \"x\" && key !== \"y\") {\r\n\t\t\t\tif (Array.isArray(value.children) && value.children.length && value.type !== \"heading\") {\r\n\t\t\t\t\tconst index = value.children.findIndex(nested => nested.children.indexOf(item) > -1) + 1;\r\n\t\t\t\t\tif (index) {\r\n\t\t\t\t\t\tconst returns = {\r\n\t\t\t\t\t\t\t...value,\r\n\t\t\t\t\t\t\tchildren: value.children.map((nested, i) => {\r\n\t\t\t\t\t\t\t\tif (i === index - 1) {\r\n\t\t\t\t\t\t\t\t\treturn {...nested, children: nested.children.filter(i => i !== item)};\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn nested;\r\n\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\treturns.children.splice(index, 0, item);\r\n\t\t\t\t\t\treturn returns;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n\r\n\tconst map = (item: List.Item, index: number, array: List.Item[]) => {\r\n\t\tconst {lines, width} = measure(item.text || \"New item...\", phone ? 17 : 20, array === tree.children ? 600 : 400);\r\n\t\treturn (\r\n\t\t\t<li class={item.type}>\r\n\t\t\t\t<textarea\r\n\t\t\t\t\tstyle={{width}}\r\n\t\t\t\t\trows={lines.length}\r\n\t\t\t\t\tvalue={item.text}\r\n\t\t\t\t\tonFocus={() => active.current = item}\r\n\t\t\t\t\tonBlur={() => active.current = null}\r\n\t\t\t\t\ttabIndex={-1}\r\n\t\t\t\t\tonInput={e => fs.change(\r\n\t\t\t\t\t\tediting,\r\n\t\t\t\t\t\t(key, value) => {\r\n\t\t\t\t\t\t\tif (key !== \"width\" && key !== \"height\" && key !== \"x\" && key !== \"y\") {\r\n\t\t\t\t\t\t\t\tif (value === item) {\r\n\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\t\t\t\t\ttext: e.currentTarget.value,\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)}\r\n\t\t\t\t\tonKeyDown={e => {\r\n\t\t\t\t\t\tif (e.key === \"Enter\") {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\tif (!item.text) {\r\n\t\t\t\t\t\t\t\tpreviousLevel(item);\r\n\t\t\t\t\t\t\t} else if (e.ctrlKey) {\r\n\t\t\t\t\t\t\t\tfs.change(\r\n\t\t\t\t\t\t\t\t\tediting,\r\n\t\t\t\t\t\t\t\t\t(key, value) => {\r\n\t\t\t\t\t\t\t\t\t\tif (key !== \"width\" && key !== \"height\" && key !== \"x\" && key !== \"y\") {\r\n\t\t\t\t\t\t\t\t\t\t\tif (value === item) {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`${item.text.slice(0, e.currentTarget.selectionStart)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\\n${item.text.slice(e.currentTarget.selectionEnd)}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t\te.currentTarget.selectionStart === e.currentTarget.selectionEnd &&\r\n\t\t\t\t\t\t\t\te.currentTarget.selectionStart === item.text.length\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tif (tree.children === array || item.children.length || e.shiftKey) {\r\n\t\t\t\t\t\t\t\t\tfs.change(\r\n\t\t\t\t\t\t\t\t\t\tediting,\r\n\t\t\t\t\t\t\t\t\t\t(key, value) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (key !== \"width\" && key !== \"height\" && key !== \"x\" && key !== \"y\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (value === item) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (item.type === \"note\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...item.children,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: \"\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren: [],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: \"note\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst returns = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...item.children\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturns.children.splice(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The index of the first note.\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// If not present, insert the new body at the last position \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(item.children.findIndex(n => n.type === \"note\") + 1) || item.children.length,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: \"\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren: [],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: `color-${Math.floor(Math.random() * 36) + 1}`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn returns;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tfs.change(\r\n\t\t\t\t\t\t\t\t\t\tediting,\r\n\t\t\t\t\t\t\t\t\t\t(key, value) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (key !== \"width\" && key !== \"height\" && key !== \"x\" && key !== \"y\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (value.children === array) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst returns = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren: [...array],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturns.children.splice(index + 1, 0, {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: \"\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren: [],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: e.shiftKey || item.type === \"note\" ? \"note\" : `color-${Math.floor(Math.random() * 36) + 1}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn returns;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\te.currentTarget.selectionEnd = e.currentTarget.selectionStart = item.text.length;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (e.key === \"Backspace\" && !item.text) {\r\n\t\t\t\t\t\t\tfs.change(\r\n\t\t\t\t\t\t\t\tediting,\r\n\t\t\t\t\t\t\t\t(key, value) => {\r\n\t\t\t\t\t\t\t\t\tif (key !== \"width\" && key !== \"height\" && key !== \"x\" && key !== \"y\") {\r\n\t\t\t\t\t\t\t\t\t\tif (value.children === array) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\t\t\t...value,\r\n\t\t\t\t\t\t\t\t\t\t\t\tchildren: array.filter(a => a !== item),\r\n\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (e.key === \"Tab\" && index && array !== tree.children) {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\tif (!e.shiftKey) {\r\n\t\t\t\t\t\t\t\tfs.change(\r\n\t\t\t\t\t\t\t\t\tediting,\r\n\t\t\t\t\t\t\t\t\t(key, value) => {\r\n\t\t\t\t\t\t\t\t\t\tif (key !== \"width\" && key !== \"height\" && key !== \"x\" && key !== \"y\") {\r\n\t\t\t\t\t\t\t\t\t\t\tif (value.children === array) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst returns = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t...value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tchildren: [...array]\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t\treturns.children.splice(index - 1, 2, {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t...array[index - 1],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tchildren: array[index - 1].children.concat(item),\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn returns;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tpreviousLevel(item);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tplaceholder=\"New item...\"\r\n\t\t\t\t/>\r\n\t\t\t\t{!item.children.length || <ul class={item.type}>{item.children.map(map)}</ul>}\r\n\t\t\t</li>\r\n\t\t);\r\n\t};\r\n\r\n\tconst add = (type: List.Item[\"type\"], index: number) => (e?: Event) => {\r\n\t\te?.preventDefault();\r\n\t\tconst isInside = (\r\n\t\t\tactive.current &&\r\n\t\t\ttree.children[index] === active.current ||\r\n\t\t\ttree.children[index].children.some(function some(i): boolean {\r\n\t\t\t\treturn i === active.current || i.children.some(some);\r\n\t\t\t})\r\n\t\t);\r\n\t\tif (isInside) {\r\n\t\t\tvar item = active.current!;\r\n\t\t} else {\r\n\t\t\tfor (\r\n\t\t\t\tvar item = tree.children[index];\r\n\t\t\t\titem.children.length;\r\n\t\t\t\titem = item.children[item.children.length - 1]\r\n\t\t\t);\r\n\t\t}\r\n\t\tconst top = tree.children.includes(item) || !!item.children.length;\r\n\t\tfs.change(\r\n\t\t\tediting,\r\n\t\t\t(key, value) => {\r\n\t\t\t\tif (key !== \"width\" && key !== \"height\" && key !== \"x\" && key !== \"y\") {\r\n\t\t\t\t\tif (value === item && top) {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\t\tchildren: [...item.children, {\r\n\t\t\t\t\t\t\t\ttext: \"\",\r\n\t\t\t\t\t\t\t\ttype,\r\n\t\t\t\t\t\t\t\tchildren: []\r\n\t\t\t\t\t\t\t}]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t} else if (!top && value.children?.includes(item)) {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t...value,\r\n\t\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t\t\t...value.children,\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\ttext: \"\",\r\n\t\t\t\t\t\t\t\t\ttype,\r\n\t\t\t\t\t\t\t\t\tchildren: []\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div style={{zoom: `${zoom * 100}%`}} ref={container}>\r\n\t\t\t<h1>\r\n\t\t\t\t<input\r\n\t\t\t\t\tvalue={tree.text}\r\n\t\t\t\t\tonInput={e => fs.change(editing, (key, value) => {\r\n\t\t\t\t\t\tif (key !== \"width\" && key !== \"height\" && key !== \"x\" && key !== \"y\") {\r\n\t\t\t\t\t\t\tif (value === fs.all[editing]) {\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t...value,\r\n\t\t\t\t\t\t\t\t\ttext: e.currentTarget.value\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})}\r\n\t\t\t\t\tonKeyUp={e => e.key === \"Enter\" && fs.change(editing, (key, value) => {\r\n\t\t\t\t\t\tif (key !== \"width\" && key !== \"height\" && key !== \"x\" && key !== \"y\") {\r\n\t\t\t\t\t\t\tif (value === fs.all[editing]) {\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t...value,\r\n\t\t\t\t\t\t\t\t\tchildren: [...value.children, {\r\n\t\t\t\t\t\t\t\t\t\ttext: \"\",\r\n\t\t\t\t\t\t\t\t\t\tchildren: [],\r\n\t\t\t\t\t\t\t\t\t\ttype: `color-${Math.floor(Math.random() * 36) + 1}`\r\n\t\t\t\t\t\t\t\t\t}]\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})}\r\n\t\t\t\t/>\r\n\t\t\t</h1>\r\n\t\t\t{fs.all[editing].children.map(map).map((tree, i) => (\r\n\t\t\t\t<ul class={`list ${tree.props.class}`} key={i}>\r\n\t\t\t\t\t{tree}\r\n\t\t\t\t\t<li class=\"add\" onMouseDown={prevent}>\r\n\t\t\t\t\t\t<Icon name=\"grid_view\" style=\"round\" role=\"button\" onClick={add(`color-${Math.floor(Math.random() * 36) + 1}`, i)} />\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li />\r\n\t\t\t\t\t<li class=\"add\" onMouseDown={prevent}>\r\n\t\t\t\t\t\t<Icon name=\"description\" style=\"round\" role=\"button\" onClick={add(\"note\", i)} />\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\ndeclare namespace List {\r\n\texport interface Props {\r\n\t\tzoom?: number;\r\n\t\tediting: number;\r\n\t\tonZoomChange?: (zoom: number) => void;\r\n\t}\r\n\r\n\texport interface Item {\r\n\t\ttext: string;\r\n\t\ttype: \"note\" | `color-${number}` | \"heading\";\r\n\t\tchildren: Item[];\r\n\t\tdescription?: string;\r\n\t\tlink?: string;\r\n\t}\r\n}\r\n\r\nexport default List;","import {useState, useEffect} from \"preact/hooks\";\r\n\r\nexport default function useMediaQuery(query: string) {\r\n\tconst [matches, setMatches] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst matchList = window.matchMedia(query);\r\n\t\tfunction change(e: MediaQueryListEvent) {\r\n\t\t\tsetMatches(e.matches);\r\n\t\t}\r\n\t\tmatchList.addEventListener(\"change\", change);\r\n\r\n\t\treturn () => {\r\n\t\t\tmatchList.removeEventListener(\"change\", change);\r\n\t\t}\r\n\t}, [query])\r\n\r\n\treturn matches;\r\n}","// DOM properties that should NOT have \"px\" added when numeric\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;\n\nconst ENCODED_ENTITIES = /[&<>\"]/;\n\nexport function encodeEntities(input) {\n\tconst s = String(input);\n\tif (!ENCODED_ENTITIES.test(s)) {\n\t\treturn s;\n\t}\n\treturn s\n\t\t.replace(/&/g, '&amp;')\n\t\t.replace(/</g, '&lt;')\n\t\t.replace(/>/g, '&gt;')\n\t\t.replace(/\"/g, '&quot;');\n}\n\nexport let indent = (s, char) =>\n\tString(s).replace(/(\\n+)/g, '$1' + (char || '\\t'));\n\nexport let isLargeString = (s, length, ignoreLines) =>\n\tString(s).length > (length || 40) ||\n\t(!ignoreLines && String(s).indexOf('\\n') !== -1) ||\n\tString(s).indexOf('<') !== -1;\n\nconst JS_TO_CSS = {};\n\n// Convert an Object style to a CSSText string\nexport function styleObjToCss(s) {\n\tlet str = '';\n\tfor (let prop in s) {\n\t\tlet val = s[prop];\n\t\tif (val != null && val !== '') {\n\t\t\tif (str) str += ' ';\n\t\t\t// str += jsToCss(prop);\n\t\t\tstr +=\n\t\t\t\tprop[0] == '-'\n\t\t\t\t\t? prop\n\t\t\t\t\t: JS_TO_CSS[prop] ||\n\t\t\t\t\t  (JS_TO_CSS[prop] = prop.replace(/([A-Z])/g, '-$1').toLowerCase());\n\t\t\tstr += ': ';\n\t\t\tstr += val;\n\t\t\tif (typeof val === 'number' && IS_NON_DIMENSIONAL.test(prop) === false) {\n\t\t\t\tstr += 'px';\n\t\t\t}\n\t\t\tstr += ';';\n\t\t}\n\t}\n\treturn str || undefined;\n}\n\n/**\n * Copy all properties from `props` onto `obj`.\n * @param {object} obj Object onto which properties should be copied.\n * @param {object} props Object from which to copy properties.\n * @returns {object}\n * @private\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn obj;\n}\n\n/**\n * Get flattened children from the children prop\n * @param {Array} accumulator\n * @param {any} children A `props.children` opaque object.\n * @returns {Array} accumulator\n * @private\n */\nexport function getChildren(accumulator, children) {\n\tif (Array.isArray(children)) {\n\t\tchildren.reduce(getChildren, accumulator);\n\t} else if (children != null && children !== false) {\n\t\taccumulator.push(children);\n\t}\n\treturn accumulator;\n}\n","import {\n\tencodeEntities,\n\tindent,\n\tisLargeString,\n\tstyleObjToCss,\n\tassign,\n\tgetChildren\n} from './util';\nimport { options, Fragment } from 'preact';\n\n/** @typedef {import('preact').VNode} VNode */\n\nconst SHALLOW = { shallow: true };\n\n// components without names, kept as a hash for later comparison to return consistent UnnamedComponentXX names.\nconst UNNAMED = [];\n\nconst VOID_ELEMENTS = /^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/;\n\nconst UNSAFE_NAME = /[\\s\\n\\\\/='\"\\0<>]/;\n\nconst noop = () => {};\n\n/** Render Preact JSX + Components to an HTML string.\n *\t@name render\n *\t@function\n *\t@param {VNode} vnode\tJSX VNode to render.\n *\t@param {Object} [context={}]\tOptionally pass an initial context object through the render path.\n *\t@param {Object} [options={}]\tRendering options\n *\t@param {Boolean} [options.shallow=false]\tIf `true`, renders nested Components as HTML elements (`<Foo a=\"b\" />`).\n *\t@param {Boolean} [options.xml=false]\t\tIf `true`, uses self-closing tags for elements without children.\n *\t@param {Boolean} [options.pretty=false]\t\tIf `true`, adds whitespace for readability\n *\t@param {RegExp|undefined} [options.voidElements]       RegeEx that matches elements that are considered void (self-closing)\n */\nrenderToString.render = renderToString;\n\n/** Only render elements, leaving Components inline as `<ComponentName ... />`.\n *\tThis method is just a convenience alias for `render(vnode, context, { shallow:true })`\n *\t@name shallow\n *\t@function\n *\t@param {VNode} vnode\tJSX VNode to render.\n *\t@param {Object} [context={}]\tOptionally pass an initial context object through the render path.\n */\nlet shallowRender = (vnode, context) => renderToString(vnode, context, SHALLOW);\n\nconst EMPTY_ARR = [];\nfunction renderToString(vnode, context, opts) {\n\tcontext = context || {};\n\topts = opts || {};\n\n\t// Performance optimization: `renderToString` is synchronous and we\n\t// therefore don't execute any effects. To do that we pass an empty\n\t// array to `options._commit` (`__c`). But we can go one step further\n\t// and avoid a lot of dirty checks and allocations by setting\n\t// `options._skipEffects` (`__s`) too.\n\tconst previousSkipEffects = options.__s;\n\toptions.__s = true;\n\n\tconst res = _renderToString(vnode, context, opts);\n\n\t// options._commit, we don't schedule any effects in this library right now,\n\t// so we can pass an empty queue to this hook.\n\tif (options.__c) options.__c(vnode, EMPTY_ARR);\n\tEMPTY_ARR.length = 0;\n\toptions.__s = previousSkipEffects;\n\treturn res;\n}\n\n/** The default export is an alias of `render()`. */\nfunction _renderToString(vnode, context, opts, inner, isSvgMode, selectValue) {\n\tif (vnode == null || typeof vnode === 'boolean') {\n\t\treturn '';\n\t}\n\n\t// #text nodes\n\tif (typeof vnode !== 'object') {\n\t\treturn encodeEntities(vnode);\n\t}\n\n\tlet pretty = opts.pretty,\n\t\tindentChar = pretty && typeof pretty === 'string' ? pretty : '\\t';\n\n\tif (Array.isArray(vnode)) {\n\t\tlet rendered = '';\n\t\tfor (let i = 0; i < vnode.length; i++) {\n\t\t\tif (pretty && i > 0) rendered += '\\n';\n\t\t\trendered += _renderToString(\n\t\t\t\tvnode[i],\n\t\t\t\tcontext,\n\t\t\t\topts,\n\t\t\t\tinner,\n\t\t\t\tisSvgMode,\n\t\t\t\tselectValue\n\t\t\t);\n\t\t}\n\t\treturn rendered;\n\t}\n\n\tlet nodeName = vnode.type,\n\t\tprops = vnode.props,\n\t\tisComponent = false;\n\n\t// components\n\tif (typeof nodeName === 'function') {\n\t\tisComponent = true;\n\t\tif (opts.shallow && (inner || opts.renderRootComponent === false)) {\n\t\t\tnodeName = getComponentName(nodeName);\n\t\t} else if (nodeName === Fragment) {\n\t\t\tconst children = [];\n\t\t\tgetChildren(children, vnode.props.children);\n\t\t\treturn _renderToString(\n\t\t\t\tchildren,\n\t\t\t\tcontext,\n\t\t\t\topts,\n\t\t\t\topts.shallowHighOrder !== false,\n\t\t\t\tisSvgMode,\n\t\t\t\tselectValue\n\t\t\t);\n\t\t} else {\n\t\t\tlet rendered;\n\n\t\t\tlet c = (vnode.__c = {\n\t\t\t\t__v: vnode,\n\t\t\t\tcontext,\n\t\t\t\tprops: vnode.props,\n\t\t\t\t// silently drop state updates\n\t\t\t\tsetState: noop,\n\t\t\t\tforceUpdate: noop,\n\t\t\t\t// hooks\n\t\t\t\t__h: []\n\t\t\t});\n\n\t\t\t// options._diff\n\t\t\tif (options.__b) options.__b(vnode);\n\n\t\t\t// options._render\n\t\t\tif (options.__r) options.__r(vnode);\n\n\t\t\tif (\n\t\t\t\t!nodeName.prototype ||\n\t\t\t\ttypeof nodeName.prototype.render !== 'function'\n\t\t\t) {\n\t\t\t\t// Necessary for createContext api. Setting this property will pass\n\t\t\t\t// the context value as `this.context` just for this component.\n\t\t\t\tlet cxType = nodeName.contextType;\n\t\t\t\tlet provider = cxType && context[cxType.__c];\n\t\t\t\tlet cctx =\n\t\t\t\t\tcxType != null\n\t\t\t\t\t\t? provider\n\t\t\t\t\t\t\t? provider.props.value\n\t\t\t\t\t\t\t: cxType.__\n\t\t\t\t\t\t: context;\n\n\t\t\t\t// stateless functional components\n\t\t\t\trendered = nodeName.call(vnode.__c, props, cctx);\n\t\t\t} else {\n\t\t\t\t// class-based components\n\t\t\t\tlet cxType = nodeName.contextType;\n\t\t\t\tlet provider = cxType && context[cxType.__c];\n\t\t\t\tlet cctx =\n\t\t\t\t\tcxType != null\n\t\t\t\t\t\t? provider\n\t\t\t\t\t\t\t? provider.props.value\n\t\t\t\t\t\t\t: cxType.__\n\t\t\t\t\t\t: context;\n\n\t\t\t\t// c = new nodeName(props, context);\n\t\t\t\tc = vnode.__c = new nodeName(props, cctx);\n\t\t\t\tc.__v = vnode;\n\t\t\t\t// turn off stateful re-rendering:\n\t\t\t\tc._dirty = c.__d = true;\n\t\t\t\tc.props = props;\n\t\t\t\tif (c.state == null) c.state = {};\n\n\t\t\t\tif (c._nextState == null && c.__s == null) {\n\t\t\t\t\tc._nextState = c.__s = c.state;\n\t\t\t\t}\n\n\t\t\t\tc.context = cctx;\n\t\t\t\tif (nodeName.getDerivedStateFromProps)\n\t\t\t\t\tc.state = assign(\n\t\t\t\t\t\tassign({}, c.state),\n\t\t\t\t\t\tnodeName.getDerivedStateFromProps(c.props, c.state)\n\t\t\t\t\t);\n\t\t\t\telse if (c.componentWillMount) {\n\t\t\t\t\tc.componentWillMount();\n\n\t\t\t\t\t// If the user called setState in cWM we need to flush pending,\n\t\t\t\t\t// state updates. This is the same behaviour in React.\n\t\t\t\t\tc.state =\n\t\t\t\t\t\tc._nextState !== c.state\n\t\t\t\t\t\t\t? c._nextState\n\t\t\t\t\t\t\t: c.__s !== c.state\n\t\t\t\t\t\t\t? c.__s\n\t\t\t\t\t\t\t: c.state;\n\t\t\t\t}\n\n\t\t\t\trendered = c.render(c.props, c.state, c.context);\n\t\t\t}\n\n\t\t\tif (c.getChildContext) {\n\t\t\t\tcontext = assign(assign({}, context), c.getChildContext());\n\t\t\t}\n\n\t\t\tif (options.diffed) options.diffed(vnode);\n\t\t\treturn _renderToString(\n\t\t\t\trendered,\n\t\t\t\tcontext,\n\t\t\t\topts,\n\t\t\t\topts.shallowHighOrder !== false,\n\t\t\t\tisSvgMode,\n\t\t\t\tselectValue\n\t\t\t);\n\t\t}\n\t}\n\n\t// render JSX to HTML\n\tlet s = '<' + nodeName,\n\t\tpropChildren,\n\t\thtml;\n\n\tif (props) {\n\t\tlet attrs = Object.keys(props);\n\n\t\t// allow sorting lexicographically for more determinism (useful for tests, such as via preact-jsx-chai)\n\t\tif (opts && opts.sortAttributes === true) attrs.sort();\n\n\t\tfor (let i = 0; i < attrs.length; i++) {\n\t\t\tlet name = attrs[i],\n\t\t\t\tv = props[name];\n\t\t\tif (name === 'children') {\n\t\t\t\tpropChildren = v;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (UNSAFE_NAME.test(name)) continue;\n\n\t\t\tif (\n\t\t\t\t!(opts && opts.allAttributes) &&\n\t\t\t\t(name === 'key' ||\n\t\t\t\t\tname === 'ref' ||\n\t\t\t\t\tname === '__self' ||\n\t\t\t\t\tname === '__source')\n\t\t\t)\n\t\t\t\tcontinue;\n\n\t\t\tif (name === 'defaultValue') {\n\t\t\t\tname = 'value';\n\t\t\t} else if (name === 'className') {\n\t\t\t\tif (typeof props.class !== 'undefined') continue;\n\t\t\t\tname = 'class';\n\t\t\t} else if (isSvgMode && name.match(/^xlink:?./)) {\n\t\t\t\tname = name.toLowerCase().replace(/^xlink:?/, 'xlink:');\n\t\t\t}\n\n\t\t\tif (name === 'htmlFor') {\n\t\t\t\tif (props.for) continue;\n\t\t\t\tname = 'for';\n\t\t\t}\n\n\t\t\tif (name === 'style' && v && typeof v === 'object') {\n\t\t\t\tv = styleObjToCss(v);\n\t\t\t}\n\n\t\t\t// always use string values instead of booleans for aria attributes\n\t\t\t// also see https://github.com/preactjs/preact/pull/2347/files\n\t\t\tif (name[0] === 'a' && name['1'] === 'r' && typeof v === 'boolean') {\n\t\t\t\tv = String(v);\n\t\t\t}\n\n\t\t\tlet hooked =\n\t\t\t\topts.attributeHook &&\n\t\t\t\topts.attributeHook(name, v, context, opts, isComponent);\n\t\t\tif (hooked || hooked === '') {\n\t\t\t\ts += hooked;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (name === 'dangerouslySetInnerHTML') {\n\t\t\t\thtml = v && v.__html;\n\t\t\t} else if (nodeName === 'textarea' && name === 'value') {\n\t\t\t\t// <textarea value=\"a&b\"> --> <textarea>a&amp;b</textarea>\n\t\t\t\tpropChildren = v;\n\t\t\t} else if ((v || v === 0 || v === '') && typeof v !== 'function') {\n\t\t\t\tif (v === true || v === '') {\n\t\t\t\t\tv = name;\n\t\t\t\t\t// in non-xml mode, allow boolean attributes\n\t\t\t\t\tif (!opts || !opts.xml) {\n\t\t\t\t\t\ts += ' ' + name;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (name === 'value') {\n\t\t\t\t\tif (nodeName === 'select') {\n\t\t\t\t\t\tselectValue = v;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else if (\n\t\t\t\t\t\t// If we're looking at an <option> and it's the currently selected one\n\t\t\t\t\t\tnodeName === 'option' &&\n\t\t\t\t\t\tselectValue == v &&\n\t\t\t\t\t\t// and the <option> doesn't already have a selected attribute on it\n\t\t\t\t\t\ttypeof props.selected === 'undefined'\n\t\t\t\t\t) {\n\t\t\t\t\t\ts += ` selected`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ts += ` ${name}=\"${encodeEntities(v)}\"`;\n\t\t\t}\n\t\t}\n\t}\n\n\t// account for >1 multiline attribute\n\tif (pretty) {\n\t\tlet sub = s.replace(/\\n\\s*/, ' ');\n\t\tif (sub !== s && !~sub.indexOf('\\n')) s = sub;\n\t\telse if (pretty && ~s.indexOf('\\n')) s += '\\n';\n\t}\n\n\ts += '>';\n\n\tif (UNSAFE_NAME.test(nodeName))\n\t\tthrow new Error(`${nodeName} is not a valid HTML tag name in ${s}`);\n\n\tlet isVoid =\n\t\tVOID_ELEMENTS.test(nodeName) ||\n\t\t(opts.voidElements && opts.voidElements.test(nodeName));\n\tlet pieces = [];\n\n\tlet children;\n\tif (html) {\n\t\t// if multiline, indent.\n\t\tif (pretty && isLargeString(html)) {\n\t\t\thtml = '\\n' + indentChar + indent(html, indentChar);\n\t\t}\n\t\ts += html;\n\t} else if (\n\t\tpropChildren != null &&\n\t\tgetChildren((children = []), propChildren).length\n\t) {\n\t\tlet hasLarge = pretty && ~s.indexOf('\\n');\n\t\tlet lastWasText = false;\n\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tlet child = children[i];\n\n\t\t\tif (child != null && child !== false) {\n\t\t\t\tlet childSvgMode =\n\t\t\t\t\t\tnodeName === 'svg'\n\t\t\t\t\t\t\t? true\n\t\t\t\t\t\t\t: nodeName === 'foreignObject'\n\t\t\t\t\t\t\t? false\n\t\t\t\t\t\t\t: isSvgMode,\n\t\t\t\t\tret = _renderToString(\n\t\t\t\t\t\tchild,\n\t\t\t\t\t\tcontext,\n\t\t\t\t\t\topts,\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\tchildSvgMode,\n\t\t\t\t\t\tselectValue\n\t\t\t\t\t);\n\n\t\t\t\tif (pretty && !hasLarge && isLargeString(ret)) hasLarge = true;\n\n\t\t\t\t// Skip if we received an empty string\n\t\t\t\tif (ret) {\n\t\t\t\t\tif (pretty) {\n\t\t\t\t\t\tlet isText = ret.length > 0 && ret[0] != '<';\n\n\t\t\t\t\t\t// We merge adjacent text nodes, otherwise each piece would be printed\n\t\t\t\t\t\t// on a new line.\n\t\t\t\t\t\tif (lastWasText && isText) {\n\t\t\t\t\t\t\tpieces[pieces.length - 1] += ret;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpieces.push(ret);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlastWasText = isText;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpieces.push(ret);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (pretty && hasLarge) {\n\t\t\tfor (let i = pieces.length; i--; ) {\n\t\t\t\tpieces[i] = '\\n' + indentChar + indent(pieces[i], indentChar);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (pieces.length || html) {\n\t\ts += pieces.join('');\n\t} else if (opts && opts.xml) {\n\t\treturn s.substring(0, s.length - 1) + ' />';\n\t}\n\n\tif (isVoid && !children && !html) {\n\t\ts = s.replace(/>$/, ' />');\n\t} else {\n\t\tif (pretty && ~s.indexOf('\\n')) s += '\\n';\n\t\ts += `</${nodeName}>`;\n\t}\n\n\treturn s;\n}\n\nfunction getComponentName(component) {\n\treturn (\n\t\tcomponent.displayName ||\n\t\t(component !== Function && component.name) ||\n\t\tgetFallbackComponentName(component)\n\t);\n}\n\nfunction getFallbackComponentName(component) {\n\tlet str = Function.prototype.toString.call(component),\n\t\tname = (str.match(/^\\s*function\\s+([^( ]+)/) || '')[1];\n\tif (!name) {\n\t\t// search for an existing indexed name for the given component:\n\t\tlet index = -1;\n\t\tfor (let i = UNNAMED.length; i--; ) {\n\t\t\tif (UNNAMED[i] === component) {\n\t\t\t\tindex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t// not found, create a new indexed name:\n\t\tif (index < 0) {\n\t\t\tindex = UNNAMED.push(component) - 1;\n\t\t}\n\t\tname = `UnnamedComponent${index}`;\n\t}\n\treturn name;\n}\nrenderToString.shallowRender = shallowRender;\n\nexport default renderToString;\n\nexport {\n\trenderToString as render,\n\trenderToString as renderToStaticMarkup,\n\trenderToString,\n\tshallowRender\n};\n","import {Component} from \"preact\";\r\nimport {route} from \"preact-router\";\r\n\r\nclass Redirect extends Component<Redirect.Props> {\r\n\tcomponentWillMount() {\r\n\t\troute(this.props.to, true);\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\ndeclare namespace Redirect {\r\n\texport interface Props {\r\n\t\tto: string;\r\n\t}\r\n}\r\n\r\nexport default Redirect;"],"sourceRoot":""}